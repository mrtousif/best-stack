version: '3'

env:
  ENV: development

dotenv: ['.env', '.env.{{.ENV}}']

tasks:
  startUp:
    cmds:
      - dbmate up
      - pnpm hasura metadata reload
      - pnpm prisma:generate

  migrateDown:
    cmds:
      - dbmate down

  prismaPull:
    cmds: 
      - pnpm prisma db pull
      
  composeUp:
    cmds:
      - docker-compose --env-file ./.env.development up

  composeDown:
    cmds:
      - docker-compose --env-file ./.env.development down --remove-orphans
